05.10.2023

Лекция 3

---

# Слепые подписи

В криптографической литературе слепые подписи называют затемненными

Сфера их использования - банковские и торговые операции

Для надежности (на практике) этим протоколом предшествуют протоколы идентификации

Система электронных платежей, модерилующая наличный денежный оборот, должна обладать свойства:
- Неотслеживаемость прохождения платежей (банк плательщика не должен знать кому предназначени платеж)
- Неотслеживаемость связей между платежами (банк не может отследить прохождение электронной банкноты по счетам)

Для реализации этих свойств созданы протоколы ЭЦП, в которых подписывающий (банк) подписывает все сообщения (банкноты), регулируя только их количество, то есть как бы в слепую. Поэтому такие подписи называют слепыми

Соответствующие протоколы должны моделировать обычные действия с денежными вкладами (транзакции):
- Снятие со счета - протокол, позволяющий клиенту получить электронную монету, уменьшив счет на соответствующую сумму
- Платеж - передачча электронной монеты получателю, проверка его подлинности
- Депозит - Протокол, дающий возможность положить некоторую сумму на счет (плательщика), если моента не была потрачена ранее, и занести ее в список (реестр) потраченных монет

## Слепая подпись RSA

$p, q$ - простые числа, $n = p \cdot q, \varphi(n) = (p - 1)(q - 1)$, $e, n$ - открытый ключ, $d, n$ - секретный ключ, $e \cdot d = 1 \mod \varphi(n)$

A: $m \rightarrow B$

B: $R = random Z_n^*$

B: $H(m) \cdot R^e \mod n \rightarrow A$

A: $\sigma^* = (H(m) \cdot R^e)^d \mod n \rightarrow B$

Проверка

B: $(\sigma^* \cdot R^{-1})^e = H(m)$

## Слепая подпись Шнорра

$p, q$ - большие простые числа, $q | p - 1$, $g \in Z_p^*: ord_p g = q$, $x \in Z_q^*$ - секретный ключ, $y = g^{-x}$ - открытый ключ, $H$ - хеш-функция, $H(*) \in Z_q$, $m$ - сообщение, A - подписывающий, B - проверяющий

A: $k = random Z_q, R = g^k \mod p, R \rightarrow B$

B: $\alpha, \beta \in Z_q, R^* = R \cdot g^{-\alpha} \cdot y^{-\beta} \mod p, e^* = H(m, R^*), e = e^* + \beta \mod q, e \rightarrow A$

A: $s = k + x \cdot e \mod q, s \rightarrow B, s^* = s - \alpha \mod q, (e^*, s^*)$ - подпись сообщения $m$

Проверка подписи: $e^* = H(m, g^{s^*} \cdot y^{e^*})$

# Законная слепая подпись

Законная слепая подпись - это подпись и сообщение, которые не могут быть "узнаны" (проверены) никем, кроме арбитра (банк, государство)

Далее будет расмотрен модифицированный алгоритм слепой подписи RSA

$(e, n)$ - открытый ключ RSA, $E$ - функция хеширования, $m$ - сообщение, $k$ - параметр, $\#S$ - мощность множества $S$, A - подписывающий, $B$ - проверяющий

B: $R_i = random Z_n^*, i = 1, \dots, 2 \cdot k$, $\alpha_i, \beta_i \in random Z_n^*$, $u_i = E(m || \alpha_i)$, $v_i = E(\beta_i || ID_A)$, $m_i = R_i^e \cdot H(u_i || v_i) \mod n$, $m_i \rightarrow A$

A: строит случайное множество $S$: $S \subset \{ 1, \dots, 2 \cdot k \}, \# S = k$, $S \rightarrow B$

B: $\forall i \in S: (R_i, u_i, \beta_i) \rightarrow A$

A: $\forall i \in S$ проверяем равенство $m_i = R_i^e \cdot H (u_i || E(\beta_i || ID_A))$ если верно, то $b = (\prod_{i \notin S m_i})^d \mod n$, $b \rightarrow B$

B: $ss = b \cdot (\prod_{i \notin S} R_i)^{-1} \mod n$, за подписи принимают $(ss, T = \{ (\alpha_i, v_i), i \notin S \})$. Проверка подписи есть проверка равенства $ss^e = \prod_{i \notin S} H(E(m || \alpha_i) || v_i)$