26.01.2023

Лекция 2

---

Все криптосистемы можно поделить на три класса стойкости:
- теоретически стойкие (совершенные)
- практически стойкие
- ненадежные

Для совершенных шифров апостериорные вероятности открытых текстов совпадают с их априорными вероятностями

$\Sigma_B = <X, K, Y, E, D, p(X), p(K)>$ - шифр

$X$ - множество открытых текстов

$K$ - множество ключей

$Y$ - множество шифртекстов

$E$ - алгоритм шифрования

$D$ - алгоритм расшифрования

$p(X) = \{p(x), x \in X\}$

$p(K) = \{p(k), k \in K\}$

$p(y) = \sum_{E_k(x)=y} p(x) \cdot p(k)$

Условная вероятность открытого текста и ключа относительно шифртекста:
$$p(x|y) = \frac{p(x) \cdot p(y|x)}{p(y)}$$

$$p(k|y) = \frac{p(k) \cdot p(y|k)}{p(y)}$$

> [!INFO] Определение
> Шифр $\Sigma_B$ называется теоретически стойким, если $\forall x \in X, \forall y \in Y: p(x|y) = p(x)$

> [!INFO] Теорема
> Если шифр $\Sigma_B$ теоретически стойкий, то $|X| \leq |Y| \leq |K|$
> > [!INFO]- Доказательство
> > Первое неравенство очевидно. Если шифр теоретически стойкий, то $\forall x \in X, \forall y \in Y \exists k \in K: E_k(x) = y$
> >
> > Иначе $p(y, x) = 0 \Rightarrow p(x|y) = 0 \Rightarrow p(x) = 0$, что противоречит условию $p(x) > 0, \forall x \in X$
> >
> > Отсюда следует, что имеет место равенство $\forall x \in X: \{E_k(x), k \in K\} = Y$
> >
> > Следовательно $|Y| \leq |K|$



> [!INFO] Определение
> Шифры для которых $|X| = |Y|$ называют эндоморфными

> [!INFO] Теорема Шеннона
> Пусть $\Sigma_B$ шифр для которого $|X| = |Y| = |K|$, тогда шифр $\Sigma_B$ теоретически стойкий тогда и только тогда, когда выполнены два условия:
> $$\forall x \in X, \forall y \in Y: \exists! k \in K: E_k(x) = y$$
> $$p(k) = \frac{1}{|K|}$$
> > [!INFO]- Доказательство
> > **Необходимость:**
> > 
> > Пусть $\Sigma_B$ шифр для которого $|X| = |Y| = |K|$ и он теоретически стойкий, тогда $|\{E_k(x): k \in K, x \in X\}| = |Y| = |K|$
> >
> > Если $k_1 \neq k_2 \Rightarrow \forall x \in X: E_{k_1}(x) \neq E_{k_2}(x)$
> >
> > Это доказывает необходимость первого условия
> > 
> > Так как шифр теоретически стойкий, то имеет место $$\left.\matrix{p(x|y) = p(x) \\ p(x|y) = \frac{p(x) \cdot p(y|x)}{p(y)}}\right\} \Rightarrow p(y|x) = p(y) \Rightarrow \sum_{E_k(x) = y} p(k) = \sum_{E_k(x) = y} p(x) \cdot p(k) \Rightarrow p(k) = \frac{1}{|K|}$$
> > Условие второе выполнено
> > 
> > **Достаточность:**
> > 
> > Пусть первое и второе условия выполнены и $|X| = |Y| = |K| = N$
> > 
> > $p(y) = \sum_{E_k(x)=y}p(x)\cdot p(k) = \frac{1}{N} \cdot \sum_{E_k(x)=y}p(x) = \frac{1}{N}$
> > 
> > Далее $p(x|y) = \frac{p(x)\cdot p(y|x)}{p(y)} = N \cdot p(x) \cdot p(y|x)$
> > 
> > Но $p(y|x) = \sum_{E_k(x) = y} p(k) = \frac{1}{N}$  - в силу единственности ключа
> > 
> > Тогда $p(x|y) = p(x)$
> > 
> > Теорема доказана

Из теоремы Шеннона следует, что теоретически стойкими шифрами являются шифры табличного и модульного гаммирования со случайными равновероятностыми ключами, длина которых совпадает с длиной открытого текста

Пример теоретически стойкого не эндоморфного шифра

$X = \{x_0, x_1\}$

$Y = \{y_0, y_1, y_2\}$

$K = \{x_k, k_1, k_2\}$

$E_{k_i}(x_j) = y_m$

$m = (i+j) \mod 3$

$p(k_i) = \frac{1}{3}, i = 0, 1, 2$

|     |$x_0$|$x_1$|
|-----|-----|-----|
|$k_0$|$y_0$|$y_1$|
|$k_1$|$y_1$|$y_2$|
|$k_2$|$y_2$|$y_0$|


